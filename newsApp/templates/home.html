{% extends "layout.html" %}
{% block childHtml %}
<!-- BEGIN: Section and Language filters -->
<div class="filters row">

<script type="application/json" id="locationMetadata">
    {{ locationsMetadata|safe }}
</script>

<!-- BEGIN: Section dropdown -->
<div id="section-dropdown" class="dropdown pull-right">
  <span> Show news for: </span>
  <button id="section-dropdown-button"
    class="btn btn-primary dropdown-toggle"
    type="button"
    data-toggle="dropdown"
    aria-haspopup="true"
    aria-expanded="true"
    data-bind="disable: disabled" >
    <span data-bind="text: label"></span>
    <span class="caret"></span>
  </button>
  <ul class="dropdown-menu pull-right" aria-labelledby="section-dropdown-button">
    <!-- ko foreach: locations -->
      <li>
        <a href="#" data-bind="click: $parent.chooseSection">
          <img class="section-dropdown-icon" data-bind="visible: !!icon, attr:{'src': icon}">
          <span data-bind="text: displayName"></span>
        </a>
      </li>
    <!-- /ko -->
  </ul>
</div>
<!-- END: Section dropdown -->

</div>
<!-- END: Section and Language filters -->

<!-- BEGIN: News stories -->
<div id="storyList" class="center-block">
<ul class="stories list-group" data-bind="foreach: stories">
  <li class="list-group-item row story">
    <div class="col-xs-12 col-xsl-6 col-sm-3" data-bind="if: images().length > 0">
      <div data-bind="with: images()[0]">
        <img class="img-responsive center-block storyPic" data-bind="attr:{'src': src}">
        <p class="text-center small">
            Image Source:
            <a class="publisher-link" target="_blank" data-bind="text: publisher.name, attr: {href:link}"></a>
        </p>
      </div>
    </div>

    <div class="col-xs-12" data-bind="css:{'col-sm-9 col-xsl-6' : images().length > 0}">
      <h4>
        <a class="headline" target="_blank" data-bind="text : mainArticle.title, attr: {href:mainArticle.link}"></a>
        <small>
          <a class="publisher-link" target="_blank" data-bind="text: mainArticle.publisher.name, attr: {href:mainArticle.publisher.homepage}"></a>
        </small>
      </h4>
      <p data-bind="text : mainArticle.summaryTextToDisplay"></p>

      <div data-bind="if: relatedArticles">
        <em>Related</em>
        <ul data-bind="foreach: relatedArticles">
          <li data-bind="css:{'hidden-xs' : $index() > 0}">
            <a class="headline" target="_blank" data-bind="text : title, attr: {href:link}"></a>
            <small><a class="publisher-link" target="_blank" data-bind="text: publisher.name, attr: {href:publisher.homepage}"></a></small>
          </li>
        </ul>
      </div>

    </div>
  </li>
</ul>
<img  class="center-block" data-bind="visible: isDataLoading" src="{{ url_for('static', filename='loading.gif') }}">
</div>
<!-- END: News stories -->

{% endblock %}
{% block childScripts %}
  <script src="{{ url_for('static', filename='sectionDropdownViewModel.js') }}"></script>
  <script src="{{ url_for('static', filename='storyViewModel.js') }}"></script>
  <script src="{{ url_for('static', filename='storiesViewModel.js') }}"></script>
  <script src="{{ url_for('static', filename='navigate.js') }}"></script>
{% endblock %}